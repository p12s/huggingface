# huggingface
–≠—Ç–æ –ø–µ—Ä–µ–≤–æ–¥, –æ—Ä–∏–≥–∏–Ω–∞–ª ![—Ç—É—Ç](https://github.com/domschl/HuggingFaceGuidedTourForMac?tab=readme-ov-file)

# Deep Learning –≥–∞–π–¥ –æ—Ç HuggingFace –¥–ª—è Mac —Å Apple Silicon

–û–±–∑–æ—Ä —Ç–æ–≥–æ, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `pytorch` –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–æ–≤—ã–π `MLX` –æ—Ç Apple –∏/–∏–ª–∏ `tensorflow` –∏–ª–∏ `JAX` –æ—Ç Google –Ω–∞ Apple Silicon Mac –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ `HuggingFace` –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤. –ü–æ—Å–ª–µ–¥–Ω–∏–µ Mac –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ö–æ—Ä–æ—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–¥–∞—á –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

–í—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `homebrew` 
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `pytorch` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MPS (metal performance shaders) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ Apple Silicon
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ `mlx` –æ—Ç Apple ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `JAX` —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ Metal –æ—Ç Apple (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç (2025-04), –∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ.) ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `tensorflow` —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø–æ–¥–∫–ª—é—á–∞–µ–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞ Metal –æ—Ç Apple ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/legacy-optional-brightgreen.svg?style=flat)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `jupyter lab` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Jupyter notebook
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `huggingface` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é `transformers` –∏ –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –≤ jupyter lab.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

- –ó–∞–ø—É—Å–∫ –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM), –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏: Llama 2 –∏–ª–∏ Llama 3 —Å llama.cpp (s.b.) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—Å–∫–æ—Ä–µ–Ω–∏—è Mac Metal.

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)

(–ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**, –µ—Å–ª–∏ –≤—ã –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≤—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)  

### –ß—Ç–æ —Ç–∞–∫–æ–µ Tensorflow, JAX, Pytorch –∏ MLX –∏ –∫–∞–∫ Huggingface —Å–æ –≤—Å–µ–º —ç—Ç–∏–º —Å–≤—è–∑–∞–Ω?  

Tensorflow, JAX, Pytorch –∏ MLX ‚Äî —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∏ –≤—ã–≤–æ–¥–µ. –ù–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —á–µ—Ç—ã—Ä–µ—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞. Huggingface —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª—é–±–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª—å—à—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≥–æ—Ç–æ–≤—ã—Ö –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ, –∞ —Ç–∞–∫–∂–µ —Ä—è–¥ —É–¥–æ–±–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–¥–∞ –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã.  

- **Pytorch** ‚Äî —ç—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ –æ–±—â–∏–π –∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–∞–∏–±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –í —Å–ª—É—á–∞–µ —Å–æ–º–Ω–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pytorch. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º (–≤–∫–ª—é—á–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Apple Silicon).  
- **JAX** ‚Äî —ç—Ç–æ –±–æ–ª–µ–µ –Ω–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Google, –∫–æ—Ç–æ—Ä—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ —Å—á–∏—Ç–∞—é—Ç –ª—É—á—à–µ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π Tensorflow. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç GPU, TPU –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple Metal (–≤—Å–µ –µ—â–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π) –∏ —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ ¬´–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º¬ª, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–µ–≤ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ [flax](https://github.com/google/flax). JAX –Ω–∞ Apple Silicon –≤—Å–µ –µ—â–µ ¬´—ç–∫–∑–æ—Ç–∏—á–µ–Ω¬ª, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pytorch, –∞ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –∫–∞–∫ JAX, —Ç–∞–∫ –∏ MLX: MLX –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –¥–∏–Ω–∞–º–∏—á–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É (–Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç), JAX –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ (GPU –∏ TPU) –ø–æ–º–∏–º–æ Apple Silicon, –Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ `jax-metal` –Ω–µ –≤—Å–µ–≥–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤–µ—Ä—Å–∏—è–º `JAX`.  
- **MLX** ‚Äî —ç—Ç–æ –Ω–æ–≤–∏—á–æ–∫ Apple, –∏ –ø–æ—ç—Ç–æ–º—É –æ–±—â–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è) –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã, —á–µ–º —É –¥—Ä—É–≥–∏—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤. –û–Ω –∫—Ä–∞—Å–∏–≤—ã–π –∏ —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω (–æ–Ω–∏ –∏–∑–≤–ª–µ–∫–ª–∏ —É—Ä–æ–∫–∏ –∏–∑ Torch –∏ TensorFlow), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω —Å Apple Silicon. –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –æ–Ω –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ Apple –∏ –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –∏–∑—É—á–∞—Ç—å –∏–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –≥–ª—É–±–æ–∫–∏–º –æ–±—É—á–µ–Ω–∏–µ–º. –¢–æ, —á–µ–º—É –≤—ã —É—á–∏—Ç–µ—Å—å —Å MLX, –ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤ Pytorch, –Ω–æ –∏–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ, —á—Ç–æ –≤—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏, –≤ –Ω–µ-Apple-–≤—Å–µ–ª–µ–Ω–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–µ—Ä–µ–Ω–æ—Å –∫–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∞.  
- **corenet** ‚Äî —ç—Ç–æ [–Ω–µ–¥–∞–≤–Ω–æ –≤—ã–ø—É—â–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–±—É—á–µ–Ω–∏—è] Apple (https://github.com/apple/corenet), –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PyTorch –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É HuggingFace, –∞ —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã —Ç–æ–≥–æ, –∫–∞–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ MLX. –°–º. –ø—Ä–∏–º–µ—Ä: [OpenElm (MLX)](https://github.com/apple/corenet/blob/main/mlx_examples/open_elm).  
- **Tensorflow** ‚Äî —ç—Ç–æ ¬´COBOL¬ª –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∏ –æ–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º–æ–ª—á–∞–ª–∏–≤–æ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω Google. –°–∞–º Google –ø—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è PyTorch –∏ JAX/Flax, –∞ –Ω–µ –¥–ª—è Tensorflow. –ï—Å–ª–∏ –≤–∞—Å –Ω–µ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Tensorflow, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ, –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –µ–≥–æ. –ï—Å–ª–∏ –≤–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TF, —Å–æ—Å—Ç–∞–≤—å—Ç–µ –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏! –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ Pytorch –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ JAX –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.  

HuggingFace –ø—É–±–ª–∏–∫—É–µ—Ç [–û–±–∑–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–æ–¥–µ–ª–µ–π](https://huggingface.co/docs/transformers/index#supported-frameworks) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞. –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è Pytorch —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–µ-—Ñ–∞–∫—Ç–æ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏.  

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –î–ª—è (–≤–µ—Ä–æ—è—Ç–Ω–æ, —Å–ª–∏—à–∫–æ–º —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ) –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å ¬´–ß—Ç–æ —Å–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ?¬ª –≤–∑–≥–ª—è–Ω–∏—Ç–µ –Ω–∞ –±–ª–æ–∫–Ω–æ—Ç Jupyter [02-–ë–µ–Ω—á–º–∞—Ä–∫–∏](https://github.com/p12s/huggingface/blob/main/02-Benchmarks.ipynb), –∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É. –ë–ª–æ–∫–Ω–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤. –û–¥–Ω–∞–∫–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö¬ª –∑–∞–¥–∞—á –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–µ–π, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –±—É–¥–µ—Ç –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–π.  

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### 1.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ homebrew

–ï—Å–ª–∏ –≤—ã —ç—Ç–æ–≥–æ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ <https://brew.sh/> –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ homebrew.  
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤–≤–µ–¥–∏—Ç–µ `brew --version`, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ.  
–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `brew` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ–ª–µ–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π `python` –∏ `git`. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python 3.12 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Homebrew, –µ—Å–ª–∏ –≤—ã –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Tensorflow —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π Metal (–≤—Å–µ –µ—â–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è 3.11 (–≤ 2024-04)).  

#### –¢–µ–∫—É—â–∏–π Python –¥–ª—è Huggingface, Pytorch, JAX –∏ MLX, Python 3.12, Homebrew –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```bash
brew install python@3.12 git
```

#### –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Tensorflow), Python 3.11 ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)

```bash
brew install python@3.11 git
```

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –≤—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–µ –≤–µ—Ä—Å–∏–∏ Python, –∞ –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É, –∏—Å–ø–æ–ª—å–∑—É—è –Ω—É–∂–Ω—É—é –≤–∞–º –≤–µ—Ä—Å–∏—é Python –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª—É—á–∞—è.

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ï—Å–ª–∏ –≤—ã —Ç–∞–∫–∂–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Linux, —É—á—Ç–∏—Ç–µ, —á—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–µ—Ä—Å–∏–π Python –∏–Ω–æ–≥–¥–∞ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –¥–ª—è Mac –∏ Linux.

#### –°–¥–µ–ª–∞–π—Ç–µ Python –æ—Ç Homebrew —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) Apple –Ω–µ –≤–∫–ª–∞–¥—ã–≤–∞–µ—Ç –º–Ω–æ–≥–æ —Å–∏–ª –≤ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ Python –æ—Ç MacOS. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π Python –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–¥–µ–ª–∞—Ç—å Python –æ—Ç Homebrew —Å–∏—Å—Ç–µ–º–Ω—ã–º Python –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
–ò—Ç–∞–∫, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å homebrew's Python 3.11 –∏–ª–∏ 3.12 —Å–∏—Å—Ç–µ–º–Ω–æ-–≥–ª–æ–±–∞–ª—å–Ω–æ, —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ (–ø–æ—Å–ª–µ `brew install python@3.12` –∏–ª–∏ `3.11`):

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `~/.zshrc` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:

```bash
# –≠—Ç–æ –ù–ï–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å homebrew's Python 3.12 –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π:
export PATH="/opt/homebrew/opt/python@3.12/bin:$PATH"
export PATH=/opt/homebrew/opt/python@3.12/libexec/bin:$PATH
```

–ò–∑–º–µ–Ω–∏—Ç–µ –≤—Å–µ —Å—Å—ã–ª–∫–∏ `3.12` –Ω–∞ `3.11`, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å homebrew's Python 3.11 —Å–∏—Å—Ç–µ–º–Ω–æ-—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º python.

(–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—É—Ç–∏, –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ `source ~/.zshrc` –≤ —Ç–µ–∫—É—â–µ–º —Å–µ–∞–Ω—Å–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.)

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ python –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é python, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `venv`, —Å–æ–∑–¥–∞–≤ `venv` –∏–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º python. –ù–∞–ø—Ä–∏–º–µ—Ä, `/usr/bin/python3 -m venv my_venv_name` —Å–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º python macOS –æ—Ç Apple (–∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏, 2025-04, –≤—Å–µ –µ—â–µ –∑–∞—Å—Ç—Ä—è–ª –Ω–∞ –≤–µ—Ä—Å–∏–∏ 3.9.6). –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –Ω–∏–∂–µ, **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—ã**.

### 1.2 –¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

–¢–µ–ø–µ—Ä—å –∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç:

```bash
git clone https://github.com/p12s/huggingface
```

–≠—Ç–æ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥ `huggingface`

#### –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–π—Ç–µ —Å—Ä–µ–¥—É Python 3.12 –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–µ:

(–°–Ω–æ–≤–∞: –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ `3.11`, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
python3.12 -m venv huggingface
```

–°–æ–∑–¥–∞–Ω–∏–µ venv –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã (–±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã Python, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏) –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã Python –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–ª–∏, —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ—Ç –∂–µ –∫–∞—Ç–∞–ª–æ–≥ `huggingface`. –í–æ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É:

```bash
cd huggingface
source bin/activate
```

–¢–µ–ø–µ—Ä—å –∫–∞—Ç–∞–ª–æ–≥ `huggingface` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è github (–Ω–∞–ø—Ä–∏–º–µ—Ä, `00-SystemCheck.ipynb`) _–∏_ —Ñ–∞–π–ª—ã –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `bin`, `lib`, `etc`, `include`, `share`, `pyvenv.cfg`):

![–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏](https://github.com/p12s/huggingface/blob/main/Resources/ProjectFolder.png)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:** –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏–π Python, –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å—Ä–µ–¥—É, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é, —É–∫–∞–∑–∞–≤ –ø—É—Ç—å –∫ Python, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è `venv`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```bash
/opt/homebrew/opt/python@3.12/bin/python3.12 -m venv my_new_312_env
```

—è–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Python Homebrew –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ `venv`, —Ç–æ–≥–¥–∞ –∫–∞–∫

```bash
/usr/bin/python3 -m venv my_old_system_venv
```

–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ—Ä—Å–∏—é Python MacOS –æ—Ç Apple –¥–ª—è –Ω–æ–≤–æ–π —Å—Ä–µ–¥—ã.

### 1.3 –ö–æ–≥–¥–∞ –≤—ã –∑–∞–∫–æ–Ω—á–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç

–î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —ç—Ç—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É, –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
deactivate
```

–ß—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –µ–µ, –≤–æ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π `venv`, –∑–¥–µ—Å—å: `huggingface` –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
source bin/activate
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ `venv` ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)
> ![–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ](http://img.shields.io/badge/‚ö†Ô∏è-Warning:-orange.svg?style=flat) –û—á–µ–Ω—å **–Ω–µ–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ `venv`** –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º: –∫–æ–≥–¥–∞ –≤—ã –≤—Ö–æ–¥–∏—Ç–µ –≤ —Å—Ä–µ–¥—É, –∞–∫—Ç–∏–≤–∏—Ä—É—è –µ–µ –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (—Å –ø–æ–º–æ—â—å—é `source bin/activate`), `venv` **–æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º**, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–∫–∏–¥–∞–µ—Ç–µ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —á–µ–º-—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –¥—Ä—É–≥–∏–º _–ø–æ–∫–∞ –≤—ã —è–≤–Ω–æ –Ω–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç–µ_ `venv` —Å –ø–æ–º–æ—â—å—é `deactivate`.
>
> –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä—è–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—é—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ `venv`, —á—Ç–æ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [starship](https://github.com/starship/starship) (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏, –µ—Å–ª–∏ –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è —É–∫—Ä–∞—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ [`Oh My Zsh`](https://ohmyz.sh/).

![–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ venv](https://github.com/p12s/huggingface/blob/main/Resources/no_venv.png)
_–ü—Ä–∏–º–µ—Ä —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º `powerlevel10k`. –í –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –∫–∞—Ç–∞–ª–æ–≥, –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ ‚Äî –∏–º—è `venv`. –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è `venv` –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω._

–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ `venv` –≤ `huggingface`:

![venv –≤—Å–µ –µ—â–µ –∞–∫—Ç–∏–≤–µ–Ω](https://github.com/p12s/huggingface/blob/main/Resources/venv_remind.png)
_–î–∞–∂–µ –µ—Å–ª–∏ —Ä–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ –∏–∑–º–µ–Ω–µ–Ω (–∑–¥–µ—Å—å –Ω–∞ `home`), —Ç–∞–∫ –∫–∞–∫ `venv` –≤—Å–µ –µ—â–µ –∞–∫—Ç–∏–≤–µ–Ω, –µ–≥–æ –∏–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ —Å –ø–æ–º–æ—â—å—é `powerlevel10k`. –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ._

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö Python —Å–º. <https://docs.python.org/3/tutorial/venv.html>.

### 2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `pytorch`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ —Å –ø–æ–º–æ—â—å—é `pip -V` (–∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞ V), —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –¥–ª—è `pip` –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ:

`<your-path>/huggingface/lib/python3.12/site-packages/pip (python 3.12)`

–ü–æ—Å–ª–µ `https://pytorch.org` –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º Pytorch —Å –ø–æ–º–æ—â—å—é `pip`. –í–∞–º –Ω—É–∂–Ω–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –≤–µ—Ä—Å–∏—è 2.x (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å 2023 –≥–æ–¥–∞), —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É MPS (Metal Performance Shaders) –≤ pytorch, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ Apple Silicon.

–ß—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `pytorch` –≤ `venv`:

```bash
pip install -U torch numpy torchvision torchaudio
```

#### 2.1 –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ pytorch

–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `pytorch` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —à–µ–π–¥–µ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ MPS metal, –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª, –≤–≤–µ–¥–∏—Ç–µ `python` –∏ –≤ –æ–±–æ–ª–æ—á–∫–µ python –≤–≤–µ–¥–∏—Ç–µ:

```python
import torch
# –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ MPS:
torch.backends.mps.is_available()
```

–≠—Ç–æ –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å `True`.

### 3 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `MLX` ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)

```bash
pip install -U mlx
```

#### 3.1 –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ MLX

–°–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `python` –∏ –≤–≤–µ–¥–∏—Ç–µ:

```python
import mlx.core as mx
print(mx.__version__)
```

–≠—Ç–æ –¥–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –≤–µ—Ä—Å–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä `0.16.1` (2024-07)

- –ü–æ—Å–µ—Ç–∏—Ç–µ Apple [–ø—Ä–æ–µ–∫—Ç MLX](https://github.com/ml-explore/) –∏ –æ—Å–æ–±–µ–Ω–Ω–æ [mlx-examples](https://github.com/ml-explore/mlx-examples)!
- –ù–∞ Huggingface –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ MLX, –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–Ω–µ—Å–ª–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ—Ç–µ–π –Ω–∞ MLX: [Huggingface MLX-Community](https://huggingface.co/mlx-community)
- –ù–æ–≤—ã–π [corenet](https://github.com/apple/corenet) –æ—Ç Apple –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PyTorch –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É HuggingFace, –∞ —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã —Ç–æ–≥–æ, –∫–∞–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ MLX. –°–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä: [OpenElm (MLX)](https://github.com/apple/corenet/blob/main/mlx_examples/open_elm).

## 4.1 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `JAX` ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/optional-brightgreen.svg?style=flat)

JAX ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä, –µ—Å–ª–∏ –≤—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —É—Å—Ç–æ—è–≤—à–∏—Ö—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –°–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ –æ–±—Ä–∞–∑—Ü—É `numpy`, –æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç [–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—é](https://jax.readthedocs.io/en/latest/jax-101/04-advanced-autodiff.html) ¬´–≤—Å–µ–≥–æ¬ª (–¥–ª—è –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏) –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç [–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—é](https://jax.readthedocs.io/en/latest/jax-101/03-vectorization.html) –∏ [–ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—é](https://jax.readthedocs.io/en/latest/jax-101/06-parallelism.html) –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ Python –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –æ–∂–∏–¥–∞–µ–º—É—é –æ—Ç –¥—Ä—É–≥–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (—Å–ª–æ–∏, —Ñ—É–Ω–∫—Ü–∏–∏ —Ü–∏–∫–ª–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –ø–æ–¥–æ–±–Ω—ã–µ ¬´–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ¬ª), —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, —Ç–∞–∫–æ–π –∫–∞–∫: [`flax`](https://github.com/google/flax).

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥—Ä–∞–π–≤–µ—Ä—ã `JAX` metal –Ω–∞—á–∞–ª–∏ –æ—Ç—Å—Ç–∞–≤–∞—Ç—å –æ—Ç —Ä–µ–ª–∏–∑–æ–≤ JAX, –ø–æ—ç—Ç–æ–º—É –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å [—Ç–∞–±–ª–∏—Ü—É —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏](https://pypi.org/project/jax-metal/) –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≤–µ—Ä—Å–∏–π `JAX`, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–∞–º `jax-metal`.

–ß—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é `JAX` –∏ –ø–æ—Å–ª–µ–¥–Ω—é—é `jax-metal` —Å `pip` –≤ –∞–∫—Ç–∏–≤–Ω—É—é —Å—Ä–µ–¥—É:

```bash
# –í–µ—Ä—Å–∏—è 0.4.26 –≤–∑—è—Ç–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, —É–ø–æ–º—è–Ω—É—Ç–æ–π –≤—ã—à–µ. –û–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
pip install -U jax==0.4.34 jaxlib==0.4.34 jax-metal
```

#### 4.2 –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ JAX

–ó–∞–ø—É—Å—Ç–∏—Ç–µ `python` (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è 3.12) –∏ –≤–≤–µ–¥–∏—Ç–µ:

```python
import jax
print(jax.devices()[0])
```

–î–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ):

```
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ 'METAL' —è–≤–ª—è–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π, –∏ –Ω–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ JAX –º–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

–í–ù–ò–ú–ê–ù–ò–ï: –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ –¥–æ –≤—ã–∑–æ–≤–∞ absl::InitializeLog() –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ STDERR
W0000 00:00:1721975334.430133 43061 mps_client.cc:510] –í–ù–ò–ú–ê–ù–ò–ï: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JAX Apple GPU —è–≤–ª—è–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π, –∏ –Ω–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ JAX –º–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Metal —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞: Apple M2 Max

systemMemory: 32,00 –ì–ë
maxCacheSize: 10,67 –ì–ë

I0000 00:00:1721975334.446739 43061 service.cc:145] –°–ª—É–∂–±–∞ XLA 0x60000031d100 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã METAL (—ç—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è XLA). –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
I0000 00:00:1721975334.446771 43061 service.cc:153] –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ StreamExecutor (0): Metal, <undefined>
I0000 00:00:1721975334.448269 43061 mps_client.cc:406] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å.
I0000 00:00:1721975334.448308 43061 mps_client.cc:384] XLA –±—ç–∫—ç–Ω–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ 22906109952 –±–∞–π—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ 0 –¥–ª—è SimpleAllocator.
[METAL(id=0)]
```

–ó–¥–µ—Å—å `METAL:0` ‚Äî —ç—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ JAX –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∏ Apple Silicon –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

##### –û—à–∏–±–∫–∏

–ï—Å–ª–∏ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:

```
RuntimeError: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±—ç–∫–µ–Ω–¥ 'METAL': INVALID_ARGUMENT: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–∏ API PJRT –ø–ª–∞–≥–∏–Ω–∞ PJRT (0.47) –∏ –≤–µ—Ä—Å–∏–∏ API PJRT —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ 0.54). (–í–∞–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–π –ø–∞–∫–µ—Ç –ø–ª–∞–≥–∏–Ω–∞ –∏–ª–∏ –∑–∞–¥–∞—Ç—å JAX_PLATFORMS=cpu, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç –±—ç–∫–µ–Ω–¥.)
```

–í–∞—à–∏ –≤–µ—Ä—Å–∏–∏ `jax` –∏ `jaxlib` –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å `jax-metal`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [—Ç–∞–±–ª–∏—Ü—É —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏](https://pypi.org/project/jax-metal/) –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç `jax-metal` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç—Ä–µ–±—É–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ.

- [–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–æ–≤ HuggingFace —Å JAX –∏ Flax](https://github.com/huggingface/transformers/tree/main/examples/flax)
- –î–æ–≤–æ–ª—å–Ω–æ –ª–∞–∫–æ–Ω–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Apple –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Apple JAX](https://developer.apple.com/metal/jax/).

## 4.3 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `tensorflow` ![–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ](http://img.shields.io/badge/legacy-optional-brightgreen.svg?style=flat)

> ![–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:](http://img.shields.io/badge/‚ö†-Note:-orange.svg?style=flat) Tensorflow –±—ã—Å—Ç—Ä–æ —Ç–µ—Ä—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É, –∏ –¥–∞–∂–µ Google –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è Tensorflow. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ.

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –•–æ—Ç—è Tensorflow –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Python 3.12 —Å –≤–µ—Ä—Å–∏–∏ 2.16, —É—Å–∫–æ—Ä–∏—Ç–µ–ª—å macOS `tensorflow-metal` –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è —Å 2023-09 (—Å–æ—Å—Ç–æ—è–Ω–∏–µ 2025-04) –∏ —Ç—Ä–µ–±—É–µ—Ç Python 3.11:

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ —Å `pip -V` (–∑–∞–≥–ª–∞–≤–Ω–∞—è V), —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –¥–ª—è `pip` –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ:

`<your-path>/huggingface/lib/python3.11/site-packages/pip (python 3.11)`

–°–ª–µ–¥—É—è <https://developer.apple.com/metal/tensorflow-plugin/>, –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º `tensorflow` —Å –ø–æ–º–æ—â—å—é `pip` –≤ –Ω–∞—à–µ–º `venv`:

```bash
pip install -U tensorflow tensorflow-metal
```

#### 4.4 –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Tensorflow

–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `tensorflow` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª, –≤–≤–µ–¥–∏—Ç–µ `python` –∏ –≤ –æ–±–æ–ª–æ—á–∫–µ python –≤–≤–µ–¥–∏—Ç–µ:

```python
import tensorflow as tf
tf.config.list_physical_devices('GPU')
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
```
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
```

### 5 –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è Jupyter

–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤–∞—à Apple Silicon Mac –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É `pytorch` –∏, –ø–æ –∂–µ–ª–∞–Ω–∏—é, `MLX` –∏/–∏–ª–∏ `JAX` –∏–ª–∏ `tensorflow` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Apple Metal.

–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `jupyter lab` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–ª–æ–∫–Ω–æ—Ç–æ–≤. –ß—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `jupyter lab`, —Å–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∞–∫—Ç–∏–≤–Ω–∞ (`pip -V`), –∏ –≤–≤–µ–¥–∏—Ç–µ:

```bash
pip install -U jupyterlab ipywidgets
```

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥—Ä—É–≥–∏–µ –≤–µ—Ä—Å–∏–∏ Jupyter, –ø—É—Ç—å –∫ –Ω–µ–¥–∞–≤–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Jupyter –≤ `venv` —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Å—Ä–µ–¥—É, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Jupyter:

```bash
deactivate
source bin/activate
```

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å Jupyter lab, –≤–≤–µ–¥–∏—Ç–µ:

```bash
jupyter lab
```

–î–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ —Å –∑–∞–ø—É—â–µ–Ω–Ω–æ–π `jupyter lab`. –ó–∞—Ç–µ–º –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –±–ª–æ–∫–Ω–æ—Ç Python –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–¥, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `tensorflow` –∏ `pytorch` —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

![](Resources/jupyterlab.png)

```python
import torch

print("Pytorch version:", torch.__version__)
```

–ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, –≤–∞—à Mac –≥–æ—Ç–æ–≤ –∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º —Å –≥–ª—É–±–æ–∫–∏–º –æ–±—É—á–µ–Ω–∏–µ–º.

## 6 HuggingFace

HuggingFace ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ—Å—É—Ä—Å –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å NLP –∏ –≥–ª—É–±–æ–∫–∏–º –æ–±—É—á–µ–Ω–∏–µ–º. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–æ—Å—Ç–æ–π API –¥–ª—è –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –û–Ω –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –±—ã—Å—Ç—Ä–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º —Å –≥–ª—É–±–æ–∫–∏–º –æ–±—É—á–µ–Ω–∏–µ–º.

### 6.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `transformers`

–í [–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ huggingface](https://huggingface.co/docs/transformers/installation) –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `pip` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `transformers`:

```bash
pip install -U transformers acceleration "huggingface_hub[cli]"
```

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ü—Ä–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö —Å HuggingFace –≤—ã –∑–∞–≥—Ä—É–∑–∏—Ç–µ –±–æ–ª—å—à–∏–µ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –≤–∞—à–µ–º –¥–æ–º–∞—à–Ω–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –ø–æ –∞–¥—Ä–µ—Å—É: `~/.cache/huggingface/hub`.
> –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏ –º–æ–¥–µ–ª–∏ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è, —É–¥–∞–ª–∏–≤ —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –∏–ª–∏ —á–∞—Å—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.

- `accelerate` –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π. –ü–æ–±–æ—á–Ω—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `accelerate` –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä `numpy`.

- `"huggingface_hub[cli]"` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ huggingface, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (—á–∞—Å—Ç–∏—á–Ω–æ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö) –º–æ–¥–µ–ª–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä Llama 3.

## 7 –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

### 7.1 –ü—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π

–í –∫–∞—Ç–∞–ª–æ–≥–µ `huggingface` –∏ –∞–∫—Ç–∏–≤–Ω–æ–º `venv` –∑–∞–ø—É—Å—Ç–∏—Ç–µ `jupyter lab` –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –±–ª–æ–∫–Ω–æ—Ç `00-SystemCheck.ipynb`. –°–Ω–∞—á–∞–ª–∞ –±–ª–æ–∫–Ω–æ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –µ—Å–ª–∏ –æ–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Pytorch.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `<Shift>-Enter` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —è—á–µ–µ–∫ –±–ª–æ–∫–Ω–æ—Ç–∞.

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ Jupyter Lab –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Huggingface, –≤–∞–º –Ω—É–∂–Ω–æ –ª–∏–±–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —è–¥—Ä–æ ‚Äã‚Äãpython –≤ Jupyter, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Jupyter Lab, –∏–Ω–∞—á–µ –æ–Ω –Ω–µ –Ω–∞–π–¥–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É Transformers.

–ü–æ—Å–ª–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤—ã –¥–æ–ª–∂–Ω—ã –Ω–∞–∫–æ–Ω–µ—Ü —É–≤–∏–¥–µ—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —ç—Ç–æ–≥–æ:

![](Resources/huggingface-transformers.png)

–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –º–µ—Ç–∫–∏ `–ü–û–õ–û–ñ–ò–¢–ï–õ–¨–ù–´–ô` —Å –æ—Ü–µ–Ω–∫–æ–π `0,99`, —Ç–æ –≤—ã –≥–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å HuggingFace!

> ![–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:](http://img.shields.io/badge/üìù-Note:-green.svg?style=flat) –í—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `HuggingFace` –∑–∞–≥—Ä—É–∂–∞—é—Ç –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ –±–æ–ª—å—à–∏–µ –¥–≤–æ–∏—á–Ω—ã–µ –±–ª–æ–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∞—à–µ–º –¥–æ–º–∞—à–Ω–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –ø–æ –∞–¥—Ä–µ—Å—É: `~/.cache/huggingface/hub`. –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏ –º–æ–¥–µ–ª–∏ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è, —É–¥–∞–ª–∏–≤ —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –∏–ª–∏ —á–∞—Å—Ç–∏ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.

#### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

- –ï—Å–ª–∏ —Å–∞–º–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å ('xyz –Ω–µ –Ω–∞–π–¥–µ–Ω!'), —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ pytorch, jax (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), MLX (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), tensorflow (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), jupyter –∏ transformers by huggingface —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ Python, –∏–Ω–∞—á–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –±—É–¥—É—Ç '–≤–∏–¥–µ—Ç—å' –¥—Ä—É–≥ –¥—Ä—É–≥–∞!

### 7.2 –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —á–∞—Ç-–±–æ—Ç

–í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –±–ª–æ–∫–Ω–æ—Ç [`01-ChatBot.ipynb`](https://github.com/p12s/huggingface/blob/main/01-ChatBot.ipynb), —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞ –Ω–∞ –≤–∞—à–µ–º Mac.

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥ Python:

```python
import torch 
from transformers import AutoModelForCausalLM, AutoTokenizer
from transformers.utils import logging

# Disable warnings about padding_side that cannot be rectified with current software:
logging.set_verbosity_error()

model_names = ["microsoft/DialoGPT-small", "microsoft/DialoGPT-medium", "microsoft/DialoGPT-large"]
use_model_index = 1  # Change 0: small model, 1: medium, 2: large model (requires most resources!)
model_name = model_names[use_model_index]
          
tokenizer = AutoTokenizer.from_pretrained(model_name) # , padding_side='left')
model = AutoModelForCausalLM.from_pretrained(model_name)

# The chat function: received a user input and chat-history and returns the model's reply and chat-history:
def reply(input_text, history=None):
    # encode the new user input, add the eos_token and return a tensor in Pytorch
    new_user_input_ids = tokenizer.encode(input_text + tokenizer.eos_token, return_tensors='pt')

    # append the new user input tokens to the chat history
    bot_input_ids = torch.cat([history, new_user_input_ids], dim=-1) if history is not None else new_user_input_ids

    # generated a response while limiting the total chat history to 1000 tokens, 
    chat_history_ids = model.generate(bot_input_ids, max_length=1000, pad_token_id=tokenizer.eos_token_id)

    # pretty print last ouput tokens from bot
    return tokenizer.decode(chat_history_ids[:, bot_input_ids.shape[-1]:][0], skip_special_tokens=True), chat_history_ids

history = None
while True:
    input_text = input("> ")
    if input_text in ["", "bye", "quit", "exit"]:
        break
    reply_text, history_new = reply(input_text, history)
    history=history_new
    if history.shape[1]>80:
        old_shape = history.shape
        history = history[:,-80:]
        print(f"History cut from {old_shape} to {history.shape}")
    # history_text = tokenizer.decode(history[0])
    # print(f"Current history: {history_text}")
    print(f"D_GPT: {reply_text}")
```

This shows a (quite limited and repetitive) chatbot using Microsoft's [DialoGPT](https://huggingface.co/microsoft/DialoGPT-medium?text=Hey+my+name+is+Mariama%21+How+are+you%3F) models.

Things to try:

- By changing `use_model_index` between `0..2`, you can select either a small, medium or large language model.
- To see the history that the model maintains you can uncomment the two `history_text` related lines above.
- To get rid of the downloaded models, clean up `~/.cache/huggingface/hub`. Missing stuff is automatically re-downloaded when needed.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- –í–∞—à Mac –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏—á–∞—é—Ç —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏. –ü—Ä–µ–∫—Ä–∞—Å–Ω—ã–º –ø—Ä–∏–º–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–µ–∫—Ç [`llama.cpp`](https://github.com/ggerganov/llama.cpp), –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–æ–¥ –≤—ã–≤–æ–¥–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ LLM –≤ –≤—ã—Å–æ–∫–æ–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∫–æ–¥–µ C++, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ Metal –¥–ª—è Mac.<br>–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫—É Llama 3 –∏–ª–∏ Llama 2 —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è –±–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥–∞, –∞ –∑–∞—Ç–µ–º –¥–ª—è —á–∞—Ç–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–¥–µ—Å—å:<br>[Llama.cpp —á–∞—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ Llama 2, —Å –ø–µ—Ä–≤–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Llama 3](https://github.com/p12s/huggingface/blob/main/NextSteps/llama.cpp.md). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è Llama 3.

## –†–µ—Å—É—Ä—Å—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

- –û–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö (–Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç) –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ–≤—ã—Ö –≤—ã–ø—É—Å–∫–∞—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ Huggingface ‚Äî [–≥—Ä—É–ø–ø–∞ Reddit LocalLLama](https://old.reddit.com/r/LocalLLaMA/).
- –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ä–∞–±–æ—Ç–∞—é—Ç –º–æ–¥–µ–ª–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤, ‚Äî —ç—Ç–æ –∫—É—Ä—Å –ê–Ω–¥—Ä–µ—è –ö–∞—Ä–ø–∞—Ç–∏ –Ω–∞ Youtube: [–ü–æ–¥—Ä–æ–±–Ω–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ –≤ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –∏ –æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ: —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–∫—Ä–æ–≥—Ä–∞–¥–∞](https://www.youtube.com/watch?v=VMj-3S1tku0&list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ). –ï—Å–ª–∏ –≤—ã –Ω–µ–º–Ω–æ–≥–æ –∑–Ω–∞–µ—Ç–µ Python –∏ –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ —É–º–Ω–æ–∂–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é NumPy, —ç—Ç–æ—Ç –∫—É—Ä—Å –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—É—á–∏—Ç—å—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –±–æ–ª—å—à–æ–≥–æ —è–∑—ã–∫–∞ —Å –Ω—É–ª—è.
